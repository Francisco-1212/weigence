{% extends "base.html" %}

{% block contenido %}

    <h2 style="text-align:center; margin-top: 20px;">Últimos 10 Pesajes Registrados</h2>
    <div class="dashboard-resumen">
    <div class="tarjeta resumen">
        <h3>Total Pesajes</h3>
        <p>{{ total_pesajes }}</p>
    </div>
    <div class="tarjeta alertas">
        <h3>Alertas Activas</h3>
        <p>{{ total_alertas }}</p>
    </div>
    <div class="tarjeta ultima-actualizacion">
        <h3>Última Actualización</h3>
        <p>{{ ultima_fecha }}</p>
    </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Peso (g)</th>
                <th>Alerta</th>
                <th>Fecha y Hora</th>
                <th>Acciones</th>  <!-- Nueva columna -->
            </tr>
        </thead>
        <tbody>
            {% for peso, alerta, fecha in registros %}
            <tr class="alerta-{{ alerta }}">
                <td>{{ peso }}</td>
                <td>{{ "✔️" if alerta else "❌" }}</td>
                <td>{{ fecha }}</td>
                <td>
                    <button class="accion ver" title="Ver detalle" onclick="mostrarModal('{{ peso }}', {{ alerta|lower }}, '{{ fecha }}')">
                    <i class="fas fa-eye"></i>
                    </button>

                    <button class="accion eliminar" title="Eliminar fila" onclick="eliminarFila(this)">
                      <i class="fas fa-trash-alt"></i>
                    </button>

                    <button class="accion descargar" title="Descargar datos" onclick="descargarDatos('{{ peso }}', {{ alerta|lower }}, '{{ fecha }}')">
                      <i class="fas fa-download"></i>
                    </button>

                    <button class="accion simular" title="Simular alerta" onclick="simularAlerta(this)">
                      <i class="fas fa-exclamation-triangle"></i>
                    </button>

                </td>
            </tr>
            {% endfor %}
        </tbody>

        
    </table>
<div id="modal" class="modal">
    <div class="modal-contenido">
        <span class="cerrar" onclick="cerrarModal()">&times;</span>
        <h3>Detalle del Pesaje</h3>
        <p><strong>Peso:</strong> <span id="modal-peso"></span> g</p>
        <p><strong>Alerta:</strong> <span id="modal-alerta"></span></p>
        <p><strong>Fecha:</strong> <span id="modal-fecha"></span></p>
    </div>
</div>




{% endblock %}
